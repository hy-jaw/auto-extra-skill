## 简介

该工具允许你配置特定的触发键，当按下这些键时，程序会自动执行预设的额外按键序列。该工具支持通过配置文件自定义触发键、额外按键序列、切换键（用于启动 / 暂停程序）以及按键之间的延迟时间。

## 功能特点



*   可自定义触发键：只有按下指定的键才会触发额外按键序列

*   可自定义额外按键序列：触发后自动执行的按键组合

*   支持切换键：用于启动 / 暂停程序功能

*   可调整按键之间的延迟时间

*   系统托盘支持：可通过托盘图标退出程序

*   防无限循环机制：忽略程序自动触发的按键事件

## 安装说明

### 前提条件



*   Python 3.6 或更高版本

### 安装依赖



```
pip install pywin32 ctypes pillow pystray pydirectinput
```


## 配置说明

配置文件 `keymap_config.json` 用于自定义程序行为，示例配置如下：



```
{

&#x20;   "toggle\_key": "numpad9",

&#x20;   "trigger\_keys": \["a", "s", "d", "f", "g", "h"],

&#x20;   "extra\_sequence": \["e", "q", "z"],

&#x20;   "sequence\_delay": 100

}
```

配置项说明：



*   `toggle_key`：程序的启动 / 暂停键，默认为 "numpad9"

*   `trigger_keys`：触发额外按键序列的键列表，默认为 \["a", "s", "d", "f", "g", "h"]

*   `extra_sequence`：触发后自动执行的按键序列，默认为 \["e", "q", "z"]

*   `sequence_delay`：额外序列中按键之间的延迟时间（毫秒），默认为 100


## 使用方法



1.  确保配置文件 `keymap_config.json` 已正确设置（或使用默认配置）

2.  运行程序：



```
python auto_extra_skill.py
```



1.  按配置的 `toggle_key`（默认 numpad9）切换程序激活状态

2.  在激活状态下，按下 `trigger_keys` 中定义的任何键都会触发 `extra_sequence` 中定义的按键序列

3.  再次按 `toggle_key` 可暂停程序功能

4.  右键点击系统托盘图标选择 "退出程序" 可关闭工具


## 注意事项



*   确保配置文件中的按键名称有效（参考程序中的 VK\_CODES 字典）

*   如果程序自动触发的按键序列导致异常，可尝试调整`sequence_delay`

*   程序会在当前目录生成`app_error.log`文件记录错误信息

*   若没有找到`keyboard.ico`文件，程序会自动生成一个蓝色背景的备用图标

## 常见问题



1.  **程序无法启动**：检查是否安装了所有依赖库，是否有足够的权限

2.  **按键无响应**：检查程序是否处于激活状态，触发键是否正确配置，是否有足够的权限

3.  **出现无限循环**：程序已内置防无限循环机制，若仍出现问题，请检查配置确保`trigger_keys`与`extra_sequence`没有重叠
